#!/usr/bin/env python3
"Submit a job to AWS Batch."

import boto3

batch = boto3.client('batch')

import random
import time

dois = \
['doi:10.7910/DVN/0EIQXL', 'doi:10.7910/DVN/0LCHKX', 'doi:10.7910/DVN/14RSGX', 'doi:10.7910/DVN/1WDJVC', 'doi:10.7910/DVN/1WZCEA', 'doi:10.7910/DVN/3KBCJF', 'doi:10.7910/DVN/3KOQWQ', 'doi:10.7910/DVN/3LOR3R', 'doi:10.7910/DVN/4FEJZ3', 'doi:10.7910/DVN/4KFU8S', 'doi:10.7910/DVN/4QRUPR', 'doi:10.7910/DVN/4YANG7', 'doi:10.7910/DVN/5DX7DP', 'doi:10.7910/DVN/5UVZOS', 'doi:10.7910/DVN/6KEXM7', 'doi:10.7910/DVN/6PQOPQ', 'doi:10.7910/DVN/6YNZTE', 'doi:10.7910/DVN/7BLIA3', 'doi:10.7910/DVN/7WIRJ7', 'doi:10.7910/DVN/82CULX', 'doi:10.7910/DVN/88MXJS', 'doi:10.7910/DVN/8HFVU8', 'doi:10.7910/DVN/8L1SHV', 'doi:10.7910/DVN/8QLBSA', 'doi:10.7910/DVN/8R3LTP', 'doi:10.7910/DVN/9IK577', 'doi:10.7910/DVN/9RTI0V', 'doi:10.7910/DVN/9SAX3K', 'doi:10.7910/DVN/A47LUM', 'doi:10.7910/DVN/ABT3OE', 'doi:10.7910/DVN/AGUVBE', 'doi:10.7910/DVN/AIP0V8', 'doi:10.7910/DVN/AIPWNU', 'doi:10.7910/DVN/B075NQ', 'doi:10.7910/DVN/BIZFP2', 'doi:10.7910/DVN/BJNAPD', 'doi:10.7910/DVN/BLEBHI', 'doi:10.7910/DVN/BSUNGB', 'doi:10.7910/DVN/BWU4M5', 'doi:10.7910/DVN/CTZNJV', 'doi:10.7910/DVN/CUBQSN', 'doi:10.7910/DVN/D5WS0Y', 'doi:10.7910/DVN/DDWWJW', 'doi:10.7910/DVN/DJKH4H', 'doi:10.7910/DVN/DZ7JLC', 'doi:10.7910/DVN/EB8DD8', 'doi:10.7910/DVN/EEARKA', 'doi:10.7910/DVN/EJWXAO', 'doi:10.7910/DVN/EMK9FB', 'doi:10.7910/DVN/EPBPMJ', 'doi:10.7910/DVN/F8YTX2', 'doi:10.7910/DVN/FEWFTX', 'doi:10.7910/DVN/FF3DQM', 'doi:10.7910/DVN/FP8THH', 'doi:10.7910/DVN/FR4HOU', 'doi:10.7910/DVN/FTFJTV', 'doi:10.7910/DVN/FYGHFO', 'doi:10.7910/DVN/FYQWMS', 'doi:10.7910/DVN/G8AF5G', 'doi:10.7910/DVN/GFRHAK', 'doi:10.7910/DVN/GIYFMV', 'doi:10.7910/DVN/GJTFKQ', 'doi:10.7910/DVN/GQQUQU', 'doi:10.7910/DVN/H7QR3Q', 'doi:10.7910/DVN/H9X2AB', 'doi:10.7910/DVN/HCJ6OM', 'doi:10.7910/DVN/HD7UUU', 'doi:10.7910/DVN/HFIV1A', 'doi:10.7910/DVN/HGIHGC', 'doi:10.7910/DVN/HHOIA4', 'doi:10.7910/DVN/HJXFLK', 'doi:10.7910/DVN/HKURUI', 'doi:10.7910/DVN/HMI4WY', 'doi:10.7910/DVN/HOH1F0', 'doi:10.7910/DVN/HPB1CA', 'doi:10.7910/DVN/HPMEVO', 'doi:10.7910/DVN/HS9HW3', 'doi:10.7910/DVN/HTMX3K', 'doi:10.7910/DVN/HUEPQJ', 'doi:10.7910/DVN/HWLW0J', 'doi:10.7910/DVN/HWWVAX', 'doi:10.7910/DVN/I0VEMG', 'doi:10.7910/DVN/IDJAWT', 'doi:10.7910/DVN/IEQVC7', 'doi:10.7910/DVN/IICWEY', 'doi:10.7910/DVN/J0GBTX', 'doi:10.7910/DVN/J6SEGJ', 'doi:10.7910/DVN/J7HUX3', 'doi:10.7910/DVN/J7WNTM', 'doi:10.7910/DVN/JAOQSD', 'doi:10.7910/DVN/JBYLAS', 'doi:10.7910/DVN/JYLWH1', 'doi:10.7910/DVN/JZZIYU', 'doi:10.7910/DVN/K1XN7Q', 'doi:10.7910/DVN/K6PRPG', 'doi:10.7910/DVN/K7IKES', 'doi:10.7910/DVN/K8SC39', 'doi:10.7910/DVN/KD4MXV', 'doi:10.7910/DVN/KDKPJQ', 'doi:10.7910/DVN/KE92DO', 'doi:10.7910/DVN/KG2APR', 'doi:10.7910/DVN/KMQVUA', 'doi:10.7910/DVN/KMUYUK', 'doi:10.7910/DVN/L8N4TR', 'doi:10.7910/DVN/LA4QBU', 'doi:10.7910/DVN/LADWHL', 'doi:10.7910/DVN/LBRAFG', 'doi:10.7910/DVN/LGDIZD', 'doi:10.7910/DVN/LNMEXL', 'doi:10.7910/DVN/LNPAOC', 'doi:10.7910/DVN/LVYOKM', 'doi:10.7910/DVN/LZPEQT', 'doi:10.7910/DVN/M2U0KV', 'doi:10.7910/DVN/M4DWZ3', 'doi:10.7910/DVN/MB2UKU', 'doi:10.7910/DVN/MCWFCS', 'doi:10.7910/DVN/MGUYVO', 'doi:10.7910/DVN/MKAI7J', 'doi:10.7910/DVN/MM2VWC', 'doi:10.7910/DVN/MNK26U', 'doi:10.7910/DVN/MPQGZP', 'doi:10.7910/DVN/MRWYC2', 'doi:10.7910/DVN/MT7XU0', 'doi:10.7910/DVN/MUJHGR', 'doi:10.7910/DVN/MYF97D', 'doi:10.7910/DVN/N0PBQ9', 'doi:10.7910/DVN/N9TTIA', 'doi:10.7910/DVN/NEIYVD', 'doi:10.7910/DVN/NIMLAR', 'doi:10.7910/DVN/NMJ4W9', 'doi:10.7910/DVN/NSTBR7', 'doi:10.7910/DVN/NZCGYX', 'doi:10.7910/DVN/O0JVDU', 'doi:10.7910/DVN/O11QZU', 'doi:10.7910/DVN/O1PMGO', 'doi:10.7910/DVN/O7BPYZ', 'doi:10.7910/DVN/OABGY2', 'doi:10.7910/DVN/OBDQ3H', 'doi:10.7910/DVN/ODQVVO', 'doi:10.7910/DVN/OEM7DW', 'doi:10.7910/DVN/OFQUAN', 'doi:10.7910/DVN/OMJYE5', 'doi:10.7910/DVN/OQ64S8', 'doi:10.7910/DVN/ORTDUM', 'doi:10.7910/DVN/OUAYYH', 'doi:10.7910/DVN/PJTOCG', 'doi:10.7910/DVN/PLVYXH', 'doi:10.7910/DVN/PMKK9S', 'doi:10.7910/DVN/POGK8L', 'doi:10.7910/DVN/PUIJIU', 'doi:10.7910/DVN/Q0OHLV', 'doi:10.7910/DVN/Q5QINN', 'doi:10.7910/DVN/Q8VDN0', 'doi:10.7910/DVN/QKGBSE', 'doi:10.7910/DVN/QOEBOC', 'doi:10.7910/DVN/QTUFUW', 'doi:10.7910/DVN/QWVACY', 'doi:10.7910/DVN/QXCFO2', 'doi:10.7910/DVN/QZNGVJ', 'doi:10.7910/DVN/RHAXDD', 'doi:10.7910/DVN/RWIHSL', 'doi:10.7910/DVN/RXMV9W', 'doi:10.7910/DVN/RZTWFD', 'doi:10.7910/DVN/S2VGJ1', 'doi:10.7910/DVN/S9G9XS', 'doi:10.7910/DVN/SCN9LA', 'doi:10.7910/DVN/SJBWC3', 'doi:10.7910/DVN/SK7JVV', 'doi:10.7910/DVN/SKPPLH', 'doi:10.7910/DVN/SLXRVJ', 'doi:10.7910/DVN/SMBFOZ', 'doi:10.7910/DVN/SRPTCV', 'doi:10.7910/DVN/STH14F', 'doi:10.7910/DVN/SWFNQE', 'doi:10.7910/DVN/SYJZNG', 'doi:10.7910/DVN/SZ9YXZ', 'doi:10.7910/DVN/SZODIL', 'doi:10.7910/DVN/T1TELH', 'doi:10.7910/DVN/T5DKRO', 'doi:10.7910/DVN/T9WESH', 'doi:10.7910/DVN/TCYTEO', 'doi:10.7910/DVN/THXYMC', 'doi:10.7910/DVN/TJ1ZXX', 'doi:10.7910/DVN/TPGPCR', 'doi:10.7910/DVN/TPZPIO', 'doi:10.7910/DVN/TQYWJR', 'doi:10.7910/DVN/TRIEF2', 'doi:10.7910/DVN/TVNVN3', 'doi:10.7910/DVN/TWVXKZ', 'doi:10.7910/DVN/TX3VWP', 'doi:10.7910/DVN/TYD3EC', 'doi:10.7910/DVN/TYSETW', 'doi:10.7910/DVN/U3ZQYY', 'doi:10.7910/DVN/UFZTYU', 'doi:10.7910/DVN/UI7OFK', 'doi:10.7910/DVN/UN54HD', 'doi:10.7910/DVN/UO5XSW', 'doi:10.7910/DVN/UODSVV', 'doi:10.7910/DVN/V3LLLE', 'doi:10.7910/DVN/VCFMBI', 'doi:10.7910/DVN/VCXVVF', 'doi:10.7910/DVN/VD7DDR', 'doi:10.7910/DVN/VE6VSR', 'doi:10.7910/DVN/VLS3XL', 'doi:10.7910/DVN/VPZZCQ', 'doi:10.7910/DVN/VS3CG6', 'doi:10.7910/DVN/VTF26G', 'doi:10.7910/DVN/W08NIR', 'doi:10.7910/DVN/W1YJZQ', 'doi:10.7910/DVN/W8HUKY', 'doi:10.7910/DVN/W8PXZC', 'doi:10.7910/DVN/WKJMZY', 'doi:10.7910/DVN/WPKTKJ', 'doi:10.7910/DVN/WVBZNE', 'doi:10.7910/DVN/WWQSVD', 'doi:10.7910/DVN/XC4E1I', 'doi:10.7910/DVN/XDDN2Y', 'doi:10.7910/DVN/XGQ2ZA', 'doi:10.7910/DVN/XRJ43D', 'doi:10.7910/DVN/XWAT9E', 'doi:10.7910/DVN/XYYAQC', 'doi:10.7910/DVN/Y3VPIG', 'doi:10.7910/DVN/YBCZHI', 'doi:10.7910/DVN/YMMSIC', 'doi:10.7910/DVN/YQNLWF', 'doi:10.7910/DVN/YRAJHO', 'doi:10.7910/DVN/YUM3K8', 'doi:10.7910/DVN/YUUXKU', 'doi:10.7910/DVN/ZBRTJH', 'doi:10.7910/DVN/ZFLG25', 'doi:10.7910/DVN/ZFS7LI', 'doi:10.7910/DVN/ZJQZH5', 'doi:10.7910/DVN/ZPC0D3', 'doi:10.7910/DVN/ZPDOYT', 'doi:10.7910/DVN/ZTTCOX', 'doi:10.7910/DVN/ZUH3UG', 'doi:10.7910/DVN/ZVQ90X', 'doi:10.7910/DVN/ZXZMJB']

for doi in dois:
       job_name = 'dv0000r360000ENV'+''.join(str(random.randint(100,999000)))
       response = batch.submit_job(jobName=job_name,
                       jobQueue='dataverse-queue',
                       jobDefinition='dataverse-job-def-r36-m',
                       containerOverrides={
                           "environment": [
                               {"name": "DOI", "value": doi}
                           ]
                       })
   
       print("Job ID is {}.".format(response['jobId']))


